(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55032],{2416:function(a){!/*!
 * Pusher JavaScript Library v7.4.0
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */ function(b,c){a.exports=c()}(window,function(){return function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){if(1&b&&(a=c(a)),8&b||4&b&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var e in a)c.d(d,e,(function(b){return a[b]}).bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s=2)}([function(a,b,c){"use strict";var d,e=this&&this.__extends||(d=function(a,b){return(d=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}d(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});Object.defineProperty(b,"__esModule",{value:!0});var f=256,g=function(){function a(a){void 0===a&&(a="="),this._paddingCharacter=a}return a.prototype.encodedLength=function(a){return this._paddingCharacter?(a+2)/3*4|0:(8*a+5)/6|0},a.prototype.encode=function(a){for(var b="",c=0;c<a.length-2;c+=3){var d=a[c]<<16|a[c+1]<<8|a[c+2];b+=this._encodeByte(d>>>18&63),b+=this._encodeByte(d>>>12&63),b+=this._encodeByte(d>>>6&63),b+=this._encodeByte(d>>>0&63)}var e=a.length-c;if(e>0){var d=a[c]<<16|(2===e?a[c+1]<<8:0);b+=this._encodeByte(d>>>18&63),b+=this._encodeByte(d>>>12&63),2===e?b+=this._encodeByte(d>>>6&63):b+=this._paddingCharacter||"",b+=this._paddingCharacter||""}return b},a.prototype.maxDecodedLength=function(a){return this._paddingCharacter?a/4*3|0:(6*a+7)/8|0},a.prototype.decodedLength=function(a){return this.maxDecodedLength(a.length-this._getPaddingLength(a))},a.prototype.decode=function(a){if(0===a.length)return new Uint8Array(0);for(var b=this._getPaddingLength(a),c=a.length-b,d=new Uint8Array(this.maxDecodedLength(c)),e=0,g=0,h=0,i=0,j=0,k=0,l=0;g<c-4;g+=4)i=this._decodeChar(a.charCodeAt(g+0)),j=this._decodeChar(a.charCodeAt(g+1)),k=this._decodeChar(a.charCodeAt(g+2)),l=this._decodeChar(a.charCodeAt(g+3)),d[e++]=i<<2|j>>>4,d[e++]=j<<4|k>>>2,d[e++]=k<<6|l,h|=i&f,h|=j&f,h|=k&f,h|=l&f;if(g<c-1&&(i=this._decodeChar(a.charCodeAt(g)),j=this._decodeChar(a.charCodeAt(g+1)),d[e++]=i<<2|j>>>4,h|=i&f,h|=j&f),g<c-2&&(k=this._decodeChar(a.charCodeAt(g+2)),d[e++]=j<<4|k>>>2,h|=k&f),g<c-3&&(l=this._decodeChar(a.charCodeAt(g+3)),d[e++]=k<<6|l,h|=l&f),0!==h)throw Error("Base64Coder: incorrect characters for decoding");return d},a.prototype._encodeByte=function(a){var b=a;return b+=65,b+=25-a>>>8&6,b+=51-a>>>8& -75,b+=61-a>>>8& -15,String.fromCharCode(b+=62-a>>>8&3)},a.prototype._decodeChar=function(a){var b=f;return b+=(42-a&a-44)>>>8& -f+a-43+62,b+=(46-a&a-48)>>>8& -f+a-47+63,b+=(47-a&a-58)>>>8& -f+a-48+52,b+=(64-a&a-91)>>>8& -f+a-65+0,b+=(96-a&a-123)>>>8& -f+a-97+26},a.prototype._getPaddingLength=function(a){var b=0;if(this._paddingCharacter){for(var c=a.length-1;c>=0&&a[c]===this._paddingCharacter;c--)b++;if(a.length<4||b>2)throw Error("Base64Coder: incorrect padding")}return b},a}();b.Coder=g;var h=new g;b.encode=function(a){return h.encode(a)},b.decode=function(a){return h.decode(a)};var i=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return e(b,a),b.prototype._encodeByte=function(a){var b=a;return b+=65,b+=25-a>>>8&6,b+=51-a>>>8& -75,b+=61-a>>>8& -13,String.fromCharCode(b+=62-a>>>8&49)},b.prototype._decodeChar=function(a){var b=f;return b+=(44-a&a-46)>>>8& -f+a-45+62,b+=(94-a&a-96)>>>8& -f+a-95+63,b+=(47-a&a-58)>>>8& -f+a-48+52,b+=(64-a&a-91)>>>8& -f+a-65+0,b+=(96-a&a-123)>>>8& -f+a-97+26},b}(g);b.URLSafeCoder=i;var j=new i;b.encodeURLSafe=function(a){return j.encode(a)},b.decodeURLSafe=function(a){return j.decode(a)},b.encodedLength=function(a){return h.encodedLength(a)},b.maxDecodedLength=function(a){return h.maxDecodedLength(a)},b.decodedLength=function(a){return h.decodedLength(a)}},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d="utf8: invalid string",e="utf8: invalid source encoding";function f(a){for(var b=0,c=0;c<a.length;c++){var e=a.charCodeAt(c);if(e<128)b+=1;else if(e<2048)b+=2;else if(e<55296)b+=3;else if(e<=57343){if(c>=a.length-1)throw Error(d);c++,b+=4}else throw Error(d)}return b}b.encode=function(a){for(var b=new Uint8Array(f(a)),c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);e<128?b[c++]=e:e<2048?(b[c++]=192|e>>6,b[c++]=128|63&e):e<55296?(b[c++]=224|e>>12,b[c++]=128|e>>6&63,b[c++]=128|63&e):(d++,e=(1023&e)<<10,e|=1023&a.charCodeAt(d),e+=65536,b[c++]=240|e>>18,b[c++]=128|e>>12&63,b[c++]=128|e>>6&63,b[c++]=128|63&e)}return b},b.encodedLength=f,b.decode=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];if(128&d){var f=void 0;if(d<224){if(c>=a.length)throw Error(e);var g=a[++c];if((192&g)!=128)throw Error(e);d=(31&d)<<6|63&g,f=128}else if(d<240){if(c>=a.length-1)throw Error(e);var g=a[++c],h=a[++c];if((192&g)!=128||(192&h)!=128)throw Error(e);d=(15&d)<<12|(63&g)<<6|63&h,f=2048}else if(d<248){if(c>=a.length-2)throw Error(e);var g=a[++c],h=a[++c],i=a[++c];if((192&g)!=128||(192&h)!=128||(192&i)!=128)throw Error(e);d=(15&d)<<18|(63&g)<<12|(63&h)<<6|63&i,f=65536}else throw Error(e);if(d<f||d>=55296&&d<=57343)throw Error(e);if(d>=65536){if(d>1114111)throw Error(e);d-=65536,b.push(String.fromCharCode(55296|d>>10)),d=56320|1023&d}}b.push(String.fromCharCode(d))}return b.join("")}},function(a,b,c){a.exports=c(3).default},function(a,b,c){"use strict";c.r(b);var d,e,f,g,h,i=function(){function a(a,b){this.lastId=0,this.prefix=a,this.name=b}return a.prototype.create=function(a){this.lastId++;var b=this.lastId,c=this.prefix+b,d=this.name+"["+b+"]",e=!1,f=function(){e||(a.apply(null,arguments),e=!0)};return this[b]=f,{number:b,id:c,name:d,callback:f}},a.prototype.remove=function(a){delete this[a.number]},a}(),j=new i("_pusher_script_","Pusher.ScriptReceivers"),k={VERSION:"7.4.0",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,cluster:"mt1",userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},l=function(){function a(a){this.options=a,this.receivers=a.receivers||j,this.loading={}}return a.prototype.load=function(a,b,c){var d=this;if(d.loading[a]&&d.loading[a].length>0)d.loading[a].push(c);else{d.loading[a]=[c];var e=bG.createScriptRequest(d.getPath(a,b)),f=d.receivers.create(function(b){if(d.receivers.remove(f),d.loading[a]){var c=d.loading[a];delete d.loading[a];for(var g=function(a){a||e.cleanup()},h=0;h<c.length;h++)c[h](b,g)}});e.send(f)}},a.prototype.getRoot=function(a){var b,c=bG.getDocument().location.protocol;return(a&&a.useTLS||"https:"===c?this.options.cdn_https:this.options.cdn_http).replace(/\/*$/,"")+"/"+this.options.version},a.prototype.getPath=function(a,b){return this.getRoot(b)+"/"+a+this.options.suffix+".js"},a}(),m=new i("_pusher_dependencies","Pusher.DependenciesReceivers"),n=new l({cdn_http:k.cdn_http,cdn_https:k.cdn_https,version:k.VERSION,suffix:k.dependency_suffix,receivers:m}),o={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}},p={buildLogSuffix:function(a){var b,c=o.urls[a];return c&&(c.fullUrl?b=c.fullUrl:c.path&&(b=o.baseUrl+c.path),b)?"See: "+b:""}};(g=d||(d={})).UserAuthentication="user-authentication",g.ChannelAuthorization="channel-authorization";for(var q=(h=function(a,b){return(h=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}h(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),r=function(a){function b(b){var c=this.constructor,d=a.call(this,b)||this;return Object.setPrototypeOf(d,c.prototype),d}return q(b,a),b}(Error),s=function(a){function b(b){var c=this.constructor,d=a.call(this,b)||this;return Object.setPrototypeOf(d,c.prototype),d}return q(b,a),b}(Error),t=function(a){function b(b){var c=this.constructor,d=a.call(this,b)||this;return Object.setPrototypeOf(d,c.prototype),d}return q(b,a),b}(Error),u=function(a){function b(b){var c=this.constructor,d=a.call(this,b)||this;return Object.setPrototypeOf(d,c.prototype),d}return q(b,a),b}(Error),v=function(a){function b(b){var c=this.constructor,d=a.call(this,b)||this;return Object.setPrototypeOf(d,c.prototype),d}return q(b,a),b}(Error),w=function(a){function b(b){var c=this.constructor,d=a.call(this,b)||this;return Object.setPrototypeOf(d,c.prototype),d}return q(b,a),b}(Error),x=function(a){function b(b){var c=this.constructor,d=a.call(this,b)||this;return Object.setPrototypeOf(d,c.prototype),d}return q(b,a),b}(Error),y=function(a){function b(b){var c=this.constructor,d=a.call(this,b)||this;return Object.setPrototypeOf(d,c.prototype),d}return q(b,a),b}(Error),z=function(a){function b(b,c){var d=this.constructor,e=a.call(this,c)||this;return e.status=b,Object.setPrototypeOf(e,d.prototype),e}return q(b,a),b}(Error),A=function(a,b,c,e,f){var g=bG.createXHR();for(var h in g.open("POST",c.endpoint,!0),g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.headers)g.setRequestHeader(h,c.headers[h]);return g.onreadystatechange=function(){if(4===g.readyState){if(200===g.status){var a=void 0,b=!1;try{a=JSON.parse(g.responseText),b=!0}catch(h){f(new z(200,"JSON returned from "+e.toString()+" endpoint was invalid, yet status code was 200. Data was: "+g.responseText),null)}b&&f(null,a)}else{var i="";switch(e){case d.UserAuthentication:i=p.buildLogSuffix("authenticationEndpoint");break;case d.ChannelAuthorization:i="Clients must be authenticated to join private or presence channels. "+p.buildLogSuffix("authorizationEndpoint")}f(new z(g.status,"Unable to retrieve auth string from "+e.toString()+" endpoint - "+("received status: "+g.status+" from "+c.endpoint)+". "+i),null)}}},g.send(b),g},B=String.fromCharCode,C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D={},E=0,F=C.length;E<F;E++)D[C.charAt(E)]=E;var G,H=function(a){var b=a.charCodeAt(0);return b<128?a:b<2048?B(192|b>>>6)+B(128|63&b):B(224|b>>>12&15)+B(128|b>>>6&63)+B(128|63&b)},I=function(a){var b=[0,2,1][a.length%3],c=a.charCodeAt(0)<<16|(a.length>1?a.charCodeAt(1):0)<<8|(a.length>2?a.charCodeAt(2):0);return[C.charAt(c>>>18),C.charAt(c>>>12&63),b>=2?"=":C.charAt(c>>>6&63),b>=1?"=":C.charAt(63&c)].join("")},J=window.btoa||function(a){return a.replace(/[\s\S]{1,3}/g,I)},K=function(){function a(a,b,c,d){var e=this;this.clear=b,this.timer=a(function(){e.timer&&(e.timer=d(e.timer))},c)}return a.prototype.isRunning=function(){return null!==this.timer},a.prototype.ensureAborted=function(){this.timer&&(this.clear(this.timer),this.timer=null)},a}(),L=(G=function(a,b){return(G=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}G(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)});function M(a){window.clearTimeout(a)}function N(a){window.clearInterval(a)}var O=function(a){function b(b,c){return a.call(this,setTimeout,M,b,function(a){return c(),null})||this}return L(b,a),b}(K),P=function(a){function b(b,c){return a.call(this,setInterval,N,b,function(a){return c(),a})||this}return L(b,a),b}(K),Q={now:function(){return Date.now?Date.now():new Date().valueOf()},defer:function(a){return new O(0,a)},method:function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=Array.prototype.slice.call(arguments,1);return function(b){return b[a].apply(b,d.concat(arguments))}}};function R(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=0;d<b.length;d++){var e=b[d];for(var f in e)e[f]&&e[f].constructor&&e[f].constructor===Object?a[f]=R(a[f]||{},e[f]):a[f]=e[f]}return a}function S(){for(var a=["Pusher"],b=0;b<arguments.length;b++)"string"==typeof arguments[b]?a.push(arguments[b]):a.push(_(arguments[b]));return a.join(" : ")}function T(a,b){var c=Array.prototype.indexOf;if(null===a)return -1;if(c&&a.indexOf===c)return a.indexOf(b);for(var d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return -1}function U(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(a[c],c,a)}function V(a){var b=[];return U(a,function(a,c){b.push(c)}),b}function W(a,b,c){for(var d=0;d<a.length;d++)b.call(c||window,a[d],d,a)}function X(a,b){for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d,a,c));return c}function Y(a,b){b=b||function(a){return!!a};for(var c=[],d=0;d<a.length;d++)b(a[d],d,a,c)&&c.push(a[d]);return c}function Z(a,b){var c={};return U(a,function(d,e){(b&&b(d,e,a,c)||Boolean(d))&&(c[e]=d)}),c}function $(a,b){for(var c=0;c<a.length;c++)if(b(a[c],c,a))return!0;return!1}function _(a){try{return JSON.stringify(a)}catch(b){var c,d,e;return JSON.stringify((d=[],e=[],function a(b,c){var f,g,h;switch(typeof b){case"object":if(!b)return null;for(f=0;f<d.length;f+=1)if(d[f]===b)return{$ref:e[f]};if(d.push(b),e.push(c),"[object Array]"===Object.prototype.toString.apply(b))for(f=0,h=[];f<b.length;f+=1)h[f]=a(b[f],c+"["+f+"]");else for(g in h={},b)Object.prototype.hasOwnProperty.call(b,g)&&(h[g]=a(b[g],c+"["+JSON.stringify(g)+"]"));return h;case"number":case"string":case"boolean":return b}}(c=a,"$")))}}var aa=new(function(){function a(){this.globalLog=function(a){window.console&&window.console.log&&window.console.log(a)}}return a.prototype.debug=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.log(this.globalLog,a)},a.prototype.warn=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.log(this.globalLogWarn,a)},a.prototype.error=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.log(this.globalLogError,a)},a.prototype.globalLogWarn=function(a){window.console&&window.console.warn?window.console.warn(a):this.globalLog(a)},a.prototype.globalLogError=function(a){window.console&&window.console.error?window.console.error(a):this.globalLogWarn(a)},a.prototype.log=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];var d=S.apply(this,arguments);b$.log?b$.log(d):b$.logToConsole&&a.bind(this)(d)},a}()),ab=function(a,b,c,d,e){void 0!==c.headers&&aa.warn("To send headers with the "+d.toString()+" request, you must use AJAX, rather than JSONP.");var f=a.nextAuthCallbackID.toString();a.nextAuthCallbackID++;var g=a.getDocument(),h=g.createElement("script");a.auth_callbacks[f]=function(a){e(null,a)},h.src=c.endpoint+"?callback="+encodeURIComponent("Pusher.auth_callbacks['"+f+"']")+"&"+b;var i=g.getElementsByTagName("head")[0]||g.documentElement;i.insertBefore(h,i.firstChild)},ac=function(){function a(a){this.src=a}return a.prototype.send=function(a){var b=this,c="Error loading "+b.src;b.script=document.createElement("script"),b.script.id=a.id,b.script.src=b.src,b.script.type="text/javascript",b.script.charset="UTF-8",b.script.addEventListener?(b.script.onerror=function(){a.callback(c)},b.script.onload=function(){a.callback(null)}):b.script.onreadystatechange=function(){("loaded"===b.script.readyState||"complete"===b.script.readyState)&&a.callback(null)},void 0===b.script.async&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(b.errorScript=document.createElement("script"),b.errorScript.id=a.id+"_error",b.errorScript.text=a.name+"('"+c+"');",b.script.async=b.errorScript.async=!1):b.script.async=!0;var d=document.getElementsByTagName("head")[0];d.insertBefore(b.script,d.firstChild),b.errorScript&&d.insertBefore(b.errorScript,b.script.nextSibling)},a.prototype.cleanup=function(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null},a}(),ad=function(){function a(a,b){this.url=a,this.data=b}return a.prototype.send=function(a){if(!this.request){var b,c,d,e,f,g=(c=Z(b=this.data,function(a){return void 0!==a}),X((e=function(a,b){var c={};return U(a,function(a,d){c[d]=b(a)}),c}(d=c,function(a){var b,c;return"object"==typeof a&&(a=_(a)),encodeURIComponent(J((c=b=a.toString(),c.replace(/[^\x00-\x7F]/g,H))))}),f=[],U(e,function(a,b){f.push([b,a])}),f),Q.method("join","=")).join("&")),h=this.url+"/"+a.number+"?"+g;this.request=bG.createScriptRequest(h),this.request.send(a)}},a.prototype.cleanup=function(){this.request&&this.request.cleanup()},a}(),ae=function(a,b){return function(c,d){var e="http"+(b?"s":"")+"://"+(a.host||a.options.host)+a.options.path,f=bG.createJSONPRequest(e,c),g=bG.ScriptReceivers.create(function(b,c){j.remove(g),f.cleanup(),c&&c.host&&(a.host=c.host),d&&d(b,c)});f.send(g)}};function af(a,b,c){var d=a+(b.useTLS?"s":""),e=b.useTLS?b.hostTLS:b.hostNonTLS;return d+"://"+e+c}function ag(a,b){return"/app/"+a+("?protocol="+k.PROTOCOL+"&client=js&version="+k.VERSION)+(b?"&"+b:"")}var ah=function(){function a(){this._callbacks={}}return a.prototype.get=function(a){return this._callbacks[ai(a)]},a.prototype.add=function(a,b,c){var d=ai(a);this._callbacks[d]=this._callbacks[d]||[],this._callbacks[d].push({fn:b,context:c})},a.prototype.remove=function(a,b,c){if(!a&&!b&&!c){this._callbacks={};return}var d=a?[ai(a)]:V(this._callbacks);b||c?this.removeCallback(d,b,c):this.removeAllCallbacks(d)},a.prototype.removeCallback=function(a,b,c){W(a,function(a){this._callbacks[a]=Y(this._callbacks[a]||[],function(a){return b&&b!==a.fn||c&&c!==a.context}),0===this._callbacks[a].length&&delete this._callbacks[a]},this)},a.prototype.removeAllCallbacks=function(a){W(a,function(a){delete this._callbacks[a]},this)},a}();function ai(a){return"_"+a}var aj,ak=function(){function a(a){this.callbacks=new ah,this.global_callbacks=[],this.failThrough=a}return a.prototype.bind=function(a,b,c){return this.callbacks.add(a,b,c),this},a.prototype.bind_global=function(a){return this.global_callbacks.push(a),this},a.prototype.unbind=function(a,b,c){return this.callbacks.remove(a,b,c),this},a.prototype.unbind_global=function(a){return a?(this.global_callbacks=Y(this.global_callbacks||[],function(b){return b!==a}),this):(this.global_callbacks=[],this)},a.prototype.unbind_all=function(){return this.unbind(),this.unbind_global(),this},a.prototype.emit=function(a,b,c){for(var d=0;d<this.global_callbacks.length;d++)this.global_callbacks[d](a,b);var e=this.callbacks.get(a),f=[];if(c?f.push(b,c):b&&f.push(b),e&&e.length>0)for(var d=0;d<e.length;d++)e[d].fn.apply(e[d].context||window,f);else this.failThrough&&this.failThrough(a,b);return this},a}(),al=(aj=function(a,b){return(aj=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}aj(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),am=function(a){function b(b,c,d,e,f){var g=a.call(this)||this;return g.initialize=bG.transportConnectionInitializer,g.hooks=b,g.name=c,g.priority=d,g.key=e,g.options=f,g.state="new",g.timeline=f.timeline,g.activityTimeout=f.activityTimeout,g.id=g.timeline.generateUniqueID(),g}return al(b,a),b.prototype.handlesActivityChecks=function(){return Boolean(this.hooks.handlesActivityChecks)},b.prototype.supportsPing=function(){return Boolean(this.hooks.supportsPing)},b.prototype.connect=function(){var a=this;if(this.socket||"initialized"!==this.state)return!1;var b=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(b,this.options)}catch(c){return Q.defer(function(){a.onError(c),a.changeState("closed")}),!1}return this.bindListeners(),aa.debug("Connecting",{transport:this.name,url:b}),this.changeState("connecting"),!0},b.prototype.close=function(){return!!this.socket&&(this.socket.close(),!0)},b.prototype.send=function(a){var b=this;return"open"===this.state&&(Q.defer(function(){b.socket&&b.socket.send(a)}),!0)},b.prototype.ping=function(){"open"===this.state&&this.supportsPing()&&this.socket.ping()},b.prototype.onOpen=function(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0},b.prototype.onError=function(a){this.emit("error",{type:"WebSocketError",error:a}),this.timeline.error(this.buildTimelineMessage({error:a.toString()}))},b.prototype.onClose=function(a){a?this.changeState("closed",{code:a.code,reason:a.reason,wasClean:a.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0},b.prototype.onMessage=function(a){this.emit("message",a)},b.prototype.onActivity=function(){this.emit("activity")},b.prototype.bindListeners=function(){var a=this;this.socket.onopen=function(){a.onOpen()},this.socket.onerror=function(b){a.onError(b)},this.socket.onclose=function(b){a.onClose(b)},this.socket.onmessage=function(b){a.onMessage(b)},this.supportsPing()&&(this.socket.onactivity=function(){a.onActivity()})},b.prototype.unbindListeners=function(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))},b.prototype.changeState=function(a,b){this.state=a,this.timeline.info(this.buildTimelineMessage({state:a,params:b})),this.emit(a,b)},b.prototype.buildTimelineMessage=function(a){return R({cid:this.id},a)},b}(ak),an=function(){function a(a){this.hooks=a}return a.prototype.isSupported=function(a){return this.hooks.isSupported(a)},a.prototype.createConnection=function(a,b,c,d){return new am(this.hooks,a,b,c,d)},a}(),ao=new an({urls:{getInitial:function(a,b){var c=(b.httpPath||"")+ag(a,"flash=false");return af("ws",b,c)}},handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return Boolean(bG.getWebSocketAPI())},isSupported:function(){return Boolean(bG.getWebSocketAPI())},getSocket:function(a){return bG.createWebSocket(a)}}),ap={urls:{getInitial:function(a,b){var c=(b.httpPath||"/pusher")+ag(a);return af("http",b,c)}},handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},aq=R({getSocket:function(a){return bG.HTTPFactory.createStreamingSocket(a)}},ap),ar=R({getSocket:function(a){return bG.HTTPFactory.createPollingSocket(a)}},ap),as={isSupported:function(){return bG.isXHRSupported()}},at=new an(R({},aq,as)),au=new an(R({},ar,as)),av={ws:ao,xhr_streaming:at,xhr_polling:au},aw=new an({file:"sockjs",urls:{getInitial:function(a,b){return af("http",b,b.httpPath||"/pusher")},getPath:function(a,b){return ag(a)}},handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return void 0!==window.SockJS},getSocket:function(a,b){return new window.SockJS(a,null,{js_path:n.getPath("sockjs",{useTLS:b.useTLS}),ignore_null_origin:b.ignoreNullOrigin})},beforeOpen:function(a,b){a.send(JSON.stringify({path:b}))}}),ax={isSupported:function(a){return bG.isXDRSupported(a.useTLS)}},ay=new an(R({},aq,ax)),az=new an(R({},ar,ax));av.xdr_streaming=ay,av.xdr_polling=az,av.sockjs=aw;var aA,aB,aC,aD,aE,aF,aG,aH=(aA=function(a,b){return(aA=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}aA(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),aI=new(function(a){function b(){var b=a.call(this)||this,c=b;return void 0!==window.addEventListener&&(window.addEventListener("online",function(){c.emit("online")},!1),window.addEventListener("offline",function(){c.emit("offline")},!1)),b}return aH(b,a),b.prototype.isOnline=function(){return void 0===window.navigator.onLine||window.navigator.onLine},b}(ak)),aJ=function(){function a(a,b,c){this.manager=a,this.transport=b,this.minPingDelay=c.minPingDelay,this.maxPingDelay=c.maxPingDelay,this.pingDelay=void 0}return a.prototype.createConnection=function(a,b,c,d){var e=this;d=R({},d,{activityTimeout:this.pingDelay});var f=this.transport.createConnection(a,b,c,d),g=null,h=function(){f.unbind("open",h),f.bind("closed",i),g=Q.now()},i=function(a){if(f.unbind("closed",i),1002===a.code||1003===a.code)e.manager.reportDeath();else if(!a.wasClean&&g){var b=Q.now()-g;b<2*e.maxPingDelay&&(e.manager.reportDeath(),e.pingDelay=Math.max(b/2,e.minPingDelay))}};return f.bind("open",h),f},a.prototype.isSupported=function(a){return this.manager.isAlive()&&this.transport.isSupported(a)},a}(),aK={decodeMessage:function(a){try{var b=JSON.parse(a.data),c=b.data;if("string"==typeof c)try{c=JSON.parse(b.data)}catch(d){}var e={event:b.event,channel:b.channel,data:c};return b.user_id&&(e.user_id=b.user_id),e}catch(f){throw{type:"MessageParseError",error:f,data:a.data}}},encodeMessage:function(a){return JSON.stringify(a)},processHandshake:function(a){var b=aK.decodeMessage(a);if("pusher:connection_established"===b.event){if(!b.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:b.data.socket_id,activityTimeout:1e3*b.data.activity_timeout}}if("pusher:error"===b.event)return{action:this.getCloseAction(b.data),error:this.getCloseError(b.data)};throw"Invalid handshake"},getCloseAction:function(a){if(a.code<4e3)return a.code>=1002&&a.code<=1004?"backoff":null;if(4e3===a.code)return"tls_only";if(a.code<4100)return"refused";if(a.code<4200)return"backoff";if(a.code<4300)return"retry";else return"refused"},getCloseError:function(a){return 1e3!==a.code&&1001!==a.code?{type:"PusherError",data:{code:a.code,message:a.reason||a.message}}:null}},aL=aK,aM=(aB=function(a,b){return(aB=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}aB(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),aN=function(a){function b(b,c){var d=a.call(this)||this;return d.id=b,d.transport=c,d.activityTimeout=c.activityTimeout,d.bindListeners(),d}return aM(b,a),b.prototype.handlesActivityChecks=function(){return this.transport.handlesActivityChecks()},b.prototype.send=function(a){return this.transport.send(a)},b.prototype.send_event=function(a,b,c){var d={event:a,data:b};return c&&(d.channel=c),aa.debug("Event sent",d),this.send(aL.encodeMessage(d))},b.prototype.ping=function(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})},b.prototype.close=function(){this.transport.close()},b.prototype.bindListeners=function(){var a=this,b={message:function(b){var c;try{c=aL.decodeMessage(b)}catch(d){a.emit("error",{type:"MessageParseError",error:d,data:b.data})}if(void 0!==c){switch(aa.debug("Event recd",c),c.event){case"pusher:error":a.emit("error",{type:"PusherError",data:c.data});break;case"pusher:ping":a.emit("ping");break;case"pusher:pong":a.emit("pong")}a.emit("message",c)}},activity:function(){a.emit("activity")},error:function(b){a.emit("error",b)},closed:function(b){c(),b&&b.code&&a.handleCloseEvent(b),a.transport=null,a.emit("closed")}},c=function(){U(b,function(b,c){a.transport.unbind(c,b)})};U(b,function(b,c){a.transport.bind(c,b)})},b.prototype.handleCloseEvent=function(a){var b=aL.getCloseAction(a),c=aL.getCloseError(a);c&&this.emit("error",c),b&&this.emit(b,{action:b,error:c})},b}(ak),aO=function(){function a(a,b){this.transport=a,this.callback=b,this.bindListeners()}return a.prototype.close=function(){this.unbindListeners(),this.transport.close()},a.prototype.bindListeners=function(){var a=this;this.onMessage=function(b){var c;a.unbindListeners();try{c=aL.processHandshake(b)}catch(d){a.finish("error",{error:d}),a.transport.close();return}"connected"===c.action?a.finish("connected",{connection:new aN(c.id,a.transport),activityTimeout:c.activityTimeout}):(a.finish(c.action,{error:c.error}),a.transport.close())},this.onClosed=function(b){a.unbindListeners();var c=aL.getCloseAction(b)||"backoff",d=aL.getCloseError(b);a.finish(c,{error:d})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)},a.prototype.unbindListeners=function(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)},a.prototype.finish=function(a,b){this.callback(R({transport:this.transport,action:a},b))},a}(),aP=function(){function a(a,b){this.timeline=a,this.options=b||{}}return a.prototype.send=function(a,b){!this.timeline.isEmpty()&&this.timeline.send(bG.TimelineTransport.getAgent(this,a),b)},a}(),aQ=(aC=function(a,b){return(aC=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}aC(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),aR=function(a){function b(b,c){var d=a.call(this,function(a,c){aa.debug("No callbacks on "+b+" for "+a)})||this;return d.name=b,d.pusher=c,d.subscribed=!1,d.subscriptionPending=!1,d.subscriptionCancelled=!1,d}return aQ(b,a),b.prototype.authorize=function(a,b){return b(null,{auth:""})},b.prototype.trigger=function(a,b){if(0!==a.indexOf("client-"))throw new r("Event '"+a+"' does not start with 'client-'");if(!this.subscribed){var c=p.buildLogSuffix("triggeringClientEvents");aa.warn("Client event triggered before channel 'subscription_succeeded' event . "+c)}return this.pusher.send_event(a,b,this.name)},b.prototype.disconnect=function(){this.subscribed=!1,this.subscriptionPending=!1},b.prototype.handleEvent=function(a){var b=a.event,c=a.data;if("pusher_internal:subscription_succeeded"===b)this.handleSubscriptionSucceededEvent(a);else if("pusher_internal:subscription_count"===b)this.handleSubscriptionCountEvent(a);else if(0!==b.indexOf("pusher_internal:")){var d={};this.emit(b,c,d)}},b.prototype.handleSubscriptionSucceededEvent=function(a){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",a.data)},b.prototype.handleSubscriptionCountEvent=function(a){a.data.subscription_count&&(this.subscriptionCount=a.data.subscription_count),this.emit("pusher:subscription_count",a.data)},b.prototype.subscribe=function(){var a=this;!this.subscribed&&(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,function(b,c){b?(a.subscriptionPending=!1,aa.error(b.toString()),a.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:b.message},b instanceof z?{status:b.status}:{}))):a.pusher.send_event("pusher:subscribe",{auth:c.auth,channel_data:c.channel_data,channel:a.name})}))},b.prototype.unsubscribe=function(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})},b.prototype.cancelSubscription=function(){this.subscriptionCancelled=!0},b.prototype.reinstateSubscription=function(){this.subscriptionCancelled=!1},b}(ak),aS=(aD=function(a,b){return(aD=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}aD(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),aT=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return aS(b,a),b.prototype.authorize=function(a,b){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:a},b)},b}(aR),aU=function(){function a(){this.reset()}return a.prototype.get=function(a){return Object.prototype.hasOwnProperty.call(this.members,a)?{id:a,info:this.members[a]}:null},a.prototype.each=function(a){var b=this;U(this.members,function(c,d){a(b.get(d))})},a.prototype.setMyID=function(a){this.myID=a},a.prototype.onSubscription=function(a){this.members=a.presence.hash,this.count=a.presence.count,this.me=this.get(this.myID)},a.prototype.addMember=function(a){return null===this.get(a.user_id)&&this.count++,this.members[a.user_id]=a.user_info,this.get(a.user_id)},a.prototype.removeMember=function(a){var b=this.get(a.user_id);return b&&(delete this.members[a.user_id],this.count--),b},a.prototype.reset=function(){this.members={},this.count=0,this.myID=null,this.me=null},a}(),aV=(aE=function(a,b){return(aE=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}aE(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),aW=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(a){return function(b){return i([a,b])}}function i(f){if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&f[0]?d.return:f[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,f[1])).done)return e;switch(d=0,e&&(f=[2&f[0],e.value]),f[0]){case 0:case 1:e=f;break;case 4:return g.label++,{value:f[1],done:!1};case 5:g.label++,d=f[1],f=[0];continue;case 7:f=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===f[0]||2===f[0])){g=0;continue}if(3===f[0]&&(!e||f[1]>e[0]&&f[1]<e[3])){g.label=f[1];break}if(6===f[0]&&g.label<e[1]){g.label=e[1],e=f;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(f);break}e[2]&&g.ops.pop(),g.trys.pop();continue}f=b.call(a,g)}catch(h){f=[6,h],d=0}finally{c=e=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}},aX=function(a){function b(b,c){var d=a.call(this,b,c)||this;return d.members=new aU,d}return aV(b,a),b.prototype.authorize=function(b,c){var d=this;a.prototype.authorize.call(this,b,function(a,b){return function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(b){f(b)}}function h(a){try{i(d.throw(a))}catch(b){f(b)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})}(d,void 0,void 0,function(){var d,e;return aW(this,function(f){switch(f.label){case 0:if(a)return[3,3];if(!(null!=b.channel_data))return[3,1];return d=JSON.parse(b.channel_data),this.members.setMyID(d.user_id),[3,3];case 1:return[4,this.pusher.user.signinDonePromise];case 2:if(f.sent(),null==this.pusher.user.user_data)return e=p.buildLogSuffix("authorizationEndpoint"),aa.error("Invalid auth response for channel '"+this.name+"', expected 'channel_data' field. "+e+", or the user should be signed in."),c("Invalid auth response"),[2];this.members.setMyID(this.pusher.user.user_data.id),f.label=3;case 3:return c(a,b),[2]}})})})},b.prototype.handleEvent=function(a){var b=a.event;if(0===b.indexOf("pusher_internal:"))this.handleInternalEvent(a);else{var c=a.data,d={};a.user_id&&(d.user_id=a.user_id),this.emit(b,c,d)}},b.prototype.handleInternalEvent=function(a){var b=a.event,c=a.data;switch(b){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(a);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(a);break;case"pusher_internal:member_added":var d=this.members.addMember(c);this.emit("pusher:member_added",d);break;case"pusher_internal:member_removed":var e=this.members.removeMember(c);e&&this.emit("pusher:member_removed",e)}},b.prototype.handleSubscriptionSucceededEvent=function(a){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(a.data),this.emit("pusher:subscription_succeeded",this.members))},b.prototype.disconnect=function(){this.members.reset(),a.prototype.disconnect.call(this)},b}(aT),aY=c(1),aZ=c(0),a$=(aF=function(a,b){return(aF=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}aF(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),a_=function(a){function b(b,c,d){var e=a.call(this,b,c)||this;return e.key=null,e.nacl=d,e}return a$(b,a),b.prototype.authorize=function(b,c){var d=this;a.prototype.authorize.call(this,b,function(a,b){if(a){c(a,b);return}var e=b.shared_secret;if(!e){c(Error("No shared_secret key in auth payload for encrypted channel: "+d.name),null);return}d.key=Object(aZ.decode)(e),delete b.shared_secret,c(null,b)})},b.prototype.trigger=function(a,b){throw new w("Client events are not currently supported for encrypted channels")},b.prototype.handleEvent=function(b){var c=b.event,d=b.data;if(0===c.indexOf("pusher_internal:")||0===c.indexOf("pusher:")){a.prototype.handleEvent.call(this,b);return}this.handleEncryptedEvent(c,d)},b.prototype.handleEncryptedEvent=function(a,b){var c=this;if(!this.key){aa.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!b.ciphertext||!b.nonce){aa.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+b);return}var d=Object(aZ.decode)(b.ciphertext);if(d.length<this.nacl.secretbox.overheadLength){aa.error("Expected encrypted event ciphertext length to be "+this.nacl.secretbox.overheadLength+", got: "+d.length);return}var e=Object(aZ.decode)(b.nonce);if(e.length<this.nacl.secretbox.nonceLength){aa.error("Expected encrypted event nonce length to be "+this.nacl.secretbox.nonceLength+", got: "+e.length);return}var f=this.nacl.secretbox.open(d,e,this.key);if(null===f){aa.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,function(b,g){if(b){aa.error("Failed to make a request to the authEndpoint: "+g+". Unable to fetch new key, so dropping encrypted event");return}if(null===(f=c.nacl.secretbox.open(d,e,c.key))){aa.error("Failed to decrypt event with new key. Dropping encrypted event");return}c.emit(a,c.getDataToEmit(f))});return}this.emit(a,this.getDataToEmit(f))},b.prototype.getDataToEmit=function(a){var b=Object(aY.decode)(a);try{return JSON.parse(b)}catch(c){return b}},b}(aT),a0=(aG=function(a,b){return(aG=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}aG(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),a1=function(a){function b(b,c){var d=a.call(this)||this;d.state="initialized",d.connection=null,d.key=b,d.options=c,d.timeline=d.options.timeline,d.usingTLS=d.options.useTLS,d.errorCallbacks=d.buildErrorCallbacks(),d.connectionCallbacks=d.buildConnectionCallbacks(d.errorCallbacks),d.handshakeCallbacks=d.buildHandshakeCallbacks(d.errorCallbacks);var e=bG.getNetwork();return e.bind("online",function(){d.timeline.info({netinfo:"online"}),("connecting"===d.state||"unavailable"===d.state)&&d.retryIn(0)}),e.bind("offline",function(){d.timeline.info({netinfo:"offline"}),d.connection&&d.sendActivityCheck()}),d.updateStrategy(),d}return a0(b,a),b.prototype.connect=function(){if(!this.connection&&!this.runner){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}},b.prototype.send=function(a){return!!this.connection&&this.connection.send(a)},b.prototype.send_event=function(a,b,c){return!!this.connection&&this.connection.send_event(a,b,c)},b.prototype.disconnect=function(){this.disconnectInternally(),this.updateState("disconnected")},b.prototype.isUsingTLS=function(){return this.usingTLS},b.prototype.startConnecting=function(){var a=this,b=function(c,d){c?a.runner=a.strategy.connect(0,b):"error"===d.action?(a.emit("error",{type:"HandshakeError",error:d.error}),a.timeline.error({handshakeError:d.error})):(a.abortConnecting(),a.handshakeCallbacks[d.action](d))};this.runner=this.strategy.connect(0,b)},b.prototype.abortConnecting=function(){this.runner&&(this.runner.abort(),this.runner=null)},b.prototype.disconnectInternally=function(){this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection&&this.abandonConnection().close()},b.prototype.updateStrategy=function(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})},b.prototype.retryIn=function(a){var b=this;this.timeline.info({action:"retry",delay:a}),a>0&&this.emit("connecting_in",Math.round(a/1e3)),this.retryTimer=new O(a||0,function(){b.disconnectInternally(),b.connect()})},b.prototype.clearRetryTimer=function(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)},b.prototype.setUnavailableTimer=function(){var a=this;this.unavailableTimer=new O(this.options.unavailableTimeout,function(){a.updateState("unavailable")})},b.prototype.clearUnavailableTimer=function(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()},b.prototype.sendActivityCheck=function(){var a=this;this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new O(this.options.pongTimeout,function(){a.timeline.error({pong_timed_out:a.options.pongTimeout}),a.retryIn(0)})},b.prototype.resetActivityCheck=function(){var a=this;this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new O(this.activityTimeout,function(){a.sendActivityCheck()}))},b.prototype.stopActivityCheck=function(){this.activityTimer&&this.activityTimer.ensureAborted()},b.prototype.buildConnectionCallbacks=function(a){var b=this;return R({},a,{message:function(a){b.resetActivityCheck(),b.emit("message",a)},ping:function(){b.send_event("pusher:pong",{})},activity:function(){b.resetActivityCheck()},error:function(a){b.emit("error",a)},closed:function(){b.abandonConnection(),b.shouldRetry()&&b.retryIn(1e3)}})},b.prototype.buildHandshakeCallbacks=function(a){var b=this;return R({},a,{connected:function(a){b.activityTimeout=Math.min(b.options.activityTimeout,a.activityTimeout,a.connection.activityTimeout||1/0),b.clearUnavailableTimer(),b.setConnection(a.connection),b.socket_id=b.connection.id,b.updateState("connected",{socket_id:b.socket_id})}})},b.prototype.buildErrorCallbacks=function(){var a=this,b=function(b){return function(c){c.error&&a.emit("error",{type:"WebSocketError",error:c.error}),b(c)}};return{tls_only:b(function(){a.usingTLS=!0,a.updateStrategy(),a.retryIn(0)}),refused:b(function(){a.disconnect()}),backoff:b(function(){a.retryIn(1e3)}),retry:b(function(){a.retryIn(0)})}},b.prototype.setConnection=function(a){for(var b in this.connection=a,this.connectionCallbacks)this.connection.bind(b,this.connectionCallbacks[b]);this.resetActivityCheck()},b.prototype.abandonConnection=function(){if(this.connection){for(var a in this.stopActivityCheck(),this.connectionCallbacks)this.connection.unbind(a,this.connectionCallbacks[a]);var b=this.connection;return this.connection=null,b}},b.prototype.updateState=function(a,b){var c=this.state;if(this.state=a,c!==a){var d=a;"connected"===d&&(d+=" with new socket ID "+b.socket_id),aa.debug("State changed",c+" -> "+d),this.timeline.info({state:a,params:b}),this.emit("state_change",{previous:c,current:a}),this.emit(a,b)}},b.prototype.shouldRetry=function(){return"connecting"===this.state||"connected"===this.state},b}(ak),a2=function(){function a(){this.channels={}}return a.prototype.add=function(a,b){return this.channels[a]||(this.channels[a]=a3(a,b)),this.channels[a]},a.prototype.all=function(){var a,b;return a=this.channels,b=[],U(a,function(a){b.push(a)}),b},a.prototype.find=function(a){return this.channels[a]},a.prototype.remove=function(a){var b=this.channels[a];return delete this.channels[a],b},a.prototype.disconnect=function(){U(this.channels,function(a){a.disconnect()})},a}();function a3(a,b){if(0===a.indexOf("private-encrypted-")){if(b.config.nacl)return a4.createEncryptedChannel(a,b,b.config.nacl);var c="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",d=p.buildLogSuffix("encryptedChannelSupport");throw new w(c+". "+d)}if(0===a.indexOf("private-"))return a4.createPrivateChannel(a,b);if(0===a.indexOf("presence-"))return a4.createPresenceChannel(a,b);if(0!==a.indexOf("#"))return a4.createChannel(a,b);throw new s('Cannot create a channel with name "'+a+'".')}var a4={createChannels:function(){return new a2},createConnectionManager:function(a,b){return new a1(a,b)},createChannel:function(a,b){return new aR(a,b)},createPrivateChannel:function(a,b){return new aT(a,b)},createPresenceChannel:function(a,b){return new aX(a,b)},createEncryptedChannel:function(a,b,c){return new a_(a,b,c)},createTimelineSender:function(a,b){return new aP(a,b)},createHandshake:function(a,b){return new aO(a,b)},createAssistantToTheTransportManager:function(a,b,c){return new aJ(a,b,c)}},a5=function(){function a(a){this.options=a||{},this.livesLeft=this.options.lives||1/0}return a.prototype.getAssistant=function(a){return a4.createAssistantToTheTransportManager(this,a,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})},a.prototype.isAlive=function(){return this.livesLeft>0},a.prototype.reportDeath=function(){this.livesLeft-=1},a}(),a6=function(){function a(a,b){this.strategies=a,this.loop=Boolean(b.loop),this.failFast=Boolean(b.failFast),this.timeout=b.timeout,this.timeoutLimit=b.timeoutLimit}return a.prototype.isSupported=function(){return $(this.strategies,Q.method("isSupported"))},a.prototype.connect=function(a,b){var c=this,d=this.strategies,e=0,f=this.timeout,g=null,h=function(i,j){j?b(null,j):(e+=1,c.loop&&(e%=d.length),e<d.length?(f&&(f*=2,c.timeoutLimit&&(f=Math.min(f,c.timeoutLimit))),g=c.tryStrategy(d[e],a,{timeout:f,failFast:c.failFast},h)):b(!0))};return g=this.tryStrategy(d[e],a,{timeout:f,failFast:this.failFast},h),{abort:function(){g.abort()},forceMinPriority:function(b){a=b,g&&g.forceMinPriority(b)}}},a.prototype.tryStrategy=function(a,b,c,d){var e=null,f=null;return c.timeout>0&&(e=new O(c.timeout,function(){f.abort(),d(!0)})),f=a.connect(b,function(a,b){(!(a&&e&&e.isRunning())||c.failFast)&&(e&&e.ensureAborted(),d(a,b))}),{abort:function(){e&&e.ensureAborted(),f.abort()},forceMinPriority:function(a){f.forceMinPriority(a)}}},a}(),a7=function(){function a(a){this.strategies=a}return a.prototype.isSupported=function(){return $(this.strategies,Q.method("isSupported"))},a.prototype.connect=function(a,b){return a8(this.strategies,a,function(a,c){return function(d,e){if(c[a].error=d,d){a9(c)&&b(!0);return}W(c,function(a){a.forceMinPriority(e.transport.priority)}),b(null,e)}})},a}();function a8(a,b,c){var d=X(a,function(a,d,e,f){return a.connect(b,c(d,f))});return{abort:function(){W(d,ba)},forceMinPriority:function(a){W(d,function(b){b.forceMinPriority(a)})}}}function a9(a){return function(a,b){for(var c=0;c<a.length;c++)if(!b(a[c],c,a))return!1;return!0}(a,function(a){return Boolean(a.error)})}function ba(a){a.error||a.aborted||(a.abort(),a.aborted=!0)}var bb=function(){function a(a,b,c){this.strategy=a,this.transports=b,this.ttl=c.ttl||18e5,this.usingTLS=c.useTLS,this.timeline=c.timeline}return a.prototype.isSupported=function(){return this.strategy.isSupported()},a.prototype.connect=function(a,b){var c=this.usingTLS,d=bd(c),e=[this.strategy];if(d&&d.timestamp+this.ttl>=Q.now()){var f=this.transports[d.transport];f&&(this.timeline.info({cached:!0,transport:d.transport,latency:d.latency}),e.push(new a6([f],{timeout:2*d.latency+1e3,failFast:!0})))}var g=Q.now(),h=e.pop().connect(a,function d(f,i){f?(bf(c),e.length>0?(g=Q.now(),h=e.pop().connect(a,d)):b(f)):(be(c,i.transport.name,Q.now()-g),b(null,i))});return{abort:function(){h.abort()},forceMinPriority:function(b){a=b,h&&h.forceMinPriority(b)}}},a}();function bc(a){return"pusherTransport"+(a?"TLS":"NonTLS")}function bd(a){var b=bG.getLocalStorage();if(b)try{var c=b[bc(a)];if(c)return JSON.parse(c)}catch(d){bf(a)}return null}function be(a,b,c){var d=bG.getLocalStorage();if(d)try{d[bc(a)]=_({timestamp:Q.now(),transport:b,latency:c})}catch(e){}}function bf(a){var b=bG.getLocalStorage();if(b)try{delete b[bc(a)]}catch(c){}}var bg=function(){function a(a,b){var c=b.delay;this.strategy=a,this.options={delay:c}}return a.prototype.isSupported=function(){return this.strategy.isSupported()},a.prototype.connect=function(a,b){var c,d=this.strategy,e=new O(this.options.delay,function(){c=d.connect(a,b)});return{abort:function(){e.ensureAborted(),c&&c.abort()},forceMinPriority:function(b){a=b,c&&c.forceMinPriority(b)}}},a}(),bh=function(){function a(a,b,c){this.test=a,this.trueBranch=b,this.falseBranch=c}return a.prototype.isSupported=function(){return(this.test()?this.trueBranch:this.falseBranch).isSupported()},a.prototype.connect=function(a,b){return(this.test()?this.trueBranch:this.falseBranch).connect(a,b)},a}(),bi=function(){function a(a){this.strategy=a}return a.prototype.isSupported=function(){return this.strategy.isSupported()},a.prototype.connect=function(a,b){var c=this.strategy.connect(a,function(a,d){d&&c.abort(),b(a,d)});return c},a}();function bj(a){return function(){return a.isSupported()}}var bk,bl,bm=function(a,b,c){var d,e={};function f(b,d,f,g,h){var i=c(a,b,d,f,g,h);return e[b]=i,i}var g=Object.assign({},b,{hostNonTLS:a.wsHost+":"+a.wsPort,hostTLS:a.wsHost+":"+a.wssPort,httpPath:a.wsPath}),h=Object.assign({},g,{useTLS:!0}),i=Object.assign({},b,{hostNonTLS:a.httpHost+":"+a.httpPort,hostTLS:a.httpHost+":"+a.httpsPort,httpPath:a.httpPath}),j={loop:!0,timeout:15e3,timeoutLimit:6e4},k=new a5({lives:2,minPingDelay:1e4,maxPingDelay:a.activityTimeout}),l=new a5({lives:2,minPingDelay:1e4,maxPingDelay:a.activityTimeout}),m=f("ws","ws",3,g,k),n=f("wss","ws",3,h,k),o=f("sockjs","sockjs",1,i),p=f("xhr_streaming","xhr_streaming",1,i,l),q=f("xdr_streaming","xdr_streaming",1,i,l),r=f("xhr_polling","xhr_polling",1,i),s=f("xdr_polling","xdr_polling",1,i),t=new a6([m],j),u=new a6([n],j),v=new a6([o],j),w=new a6([new bh(bj(p),p,q)],j),x=new a6([new bh(bj(r),r,s)],j),y=new a6([new bh(bj(w),new a7([w,new bg(x,{delay:4e3})]),x)],j),z=new bh(bj(y),y,v);return d=new a7(b.useTLS?[t,new bg(z,{delay:2e3})]:[t,new bg(u,{delay:2e3}),new bg(z,{delay:5e3})]),new bb(new bi(new bh(bj(m),d,z)),e,{ttl:18e5,timeline:b.timeline,useTLS:b.useTLS})},bn=function(){var a=this;a.timeline.info(a.buildTimelineMessage({transport:a.name+(a.options.useTLS?"s":"")})),a.hooks.isInitialized()?a.changeState("initialized"):a.hooks.file?(a.changeState("initializing"),n.load(a.hooks.file,{useTLS:a.options.useTLS},function(b,c){a.hooks.isInitialized()?(a.changeState("initialized"),c(!0)):(b&&a.onError(b),a.onClose(),c(!1))})):a.onClose()},bo={getRequest:function(a){var b=new window.XDomainRequest;return b.ontimeout=function(){a.emit("error",new t),a.close()},b.onerror=function(b){a.emit("error",b),a.close()},b.onprogress=function(){b.responseText&&b.responseText.length>0&&a.onChunk(200,b.responseText)},b.onload=function(){b.responseText&&b.responseText.length>0&&a.onChunk(200,b.responseText),a.emit("finished",200),a.close()},b},abortRequest:function(a){a.ontimeout=a.onerror=a.onprogress=a.onload=null,a.abort()}},bp=(bk=function(a,b){return(bk=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}bk(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),bq=function(a){function b(b,c,d){var e=a.call(this)||this;return e.hooks=b,e.method=c,e.url=d,e}return bp(b,a),b.prototype.start=function(a){var b=this;this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=function(){b.close()},bG.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(a)},b.prototype.close=function(){this.unloader&&(bG.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)},b.prototype.onChunk=function(a,b){for(;;){var c=this.advanceBuffer(b);if(c)this.emit("chunk",{status:a,data:c});else break}this.isBufferTooLong(b)&&this.emit("buffer_too_long")},b.prototype.advanceBuffer=function(a){var b=a.slice(this.position),c=b.indexOf("\n");return -1!==c?(this.position+=c+1,b.slice(0,c)):null},b.prototype.isBufferTooLong=function(a){return this.position===a.length&&a.length>262144},b}(ak);(bl=e||(e={}))[bl.CONNECTING=0]="CONNECTING",bl[bl.OPEN=1]="OPEN",bl[bl.CLOSED=3]="CLOSED";var br=e,bs=1,bt=function(){function a(a,b){this.hooks=a,this.session=by(1e3)+"/"+bz(8),this.location=bu(b),this.readyState=br.CONNECTING,this.openStream()}return a.prototype.send=function(a){return this.sendRaw(JSON.stringify([a]))},a.prototype.ping=function(){this.hooks.sendHeartbeat(this)},a.prototype.close=function(a,b){this.onClose(a,b,!0)},a.prototype.sendRaw=function(a){if(this.readyState!==br.OPEN)return!1;try{return bG.createSocketRequest("POST",bw(bv(this.location,this.session))).start(a),!0}catch(b){return!1}},a.prototype.reconnect=function(){this.closeStream(),this.openStream()},a.prototype.onClose=function(a,b,c){this.closeStream(),this.readyState=br.CLOSED,this.onclose&&this.onclose({code:a,reason:b,wasClean:c})},a.prototype.onChunk=function(a){if(200===a.status){this.readyState===br.OPEN&&this.onActivity();var b,c=a.data.slice(0,1);switch(c){case"o":b=JSON.parse(a.data.slice(1)||"{}"),this.onOpen(b);break;case"a":b=JSON.parse(a.data.slice(1)||"[]");for(var d=0;d<b.length;d++)this.onEvent(b[d]);break;case"m":b=JSON.parse(a.data.slice(1)||"null"),this.onEvent(b);break;case"h":this.hooks.onHeartbeat(this);break;case"c":b=JSON.parse(a.data.slice(1)||"[]"),this.onClose(b[0],b[1],!0)}}},a.prototype.onOpen=function(a){this.readyState===br.CONNECTING?(a&&a.hostname&&(this.location.base=bx(this.location.base,a.hostname)),this.readyState=br.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)},a.prototype.onEvent=function(a){this.readyState===br.OPEN&&this.onmessage&&this.onmessage({data:a})},a.prototype.onActivity=function(){this.onactivity&&this.onactivity()},a.prototype.onError=function(a){this.onerror&&this.onerror(a)},a.prototype.openStream=function(){var a=this;this.stream=bG.createSocketRequest("POST",bw(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",function(b){a.onChunk(b)}),this.stream.bind("finished",function(b){a.hooks.onFinished(a,b)}),this.stream.bind("buffer_too_long",function(){a.reconnect()});try{this.stream.start()}catch(b){Q.defer(function(){a.onError(b),a.onClose(1006,"Could not start streaming",!1)})}},a.prototype.closeStream=function(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)},a}();function bu(a){var b=/([^\?]*)\/*(\??.*)/.exec(a);return{base:b[1],queryString:b[2]}}function bv(a,b){return a.base+"/"+b+"/xhr_send"}function bw(a){var b=-1===a.indexOf("?")?"?":"&";return a+b+"t="+ +new Date+"&n="+bs++}function bx(a,b){var c=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(a);return c[1]+b+c[3]}function by(a){return Math.floor(Math.random()*a)}function bz(a){for(var b=[],c=0;c<a;c++)b.push(by(32).toString(32));return b.join("")}var bA=bt,bB={getReceiveURL:function(a,b){return a.base+"/"+b+"/xhr_streaming"+a.queryString},onHeartbeat:function(a){a.sendRaw("[]")},sendHeartbeat:function(a){a.sendRaw("[]")},onFinished:function(a,b){a.onClose(1006,"Connection interrupted ("+b+")",!1)}},bC={getReceiveURL:function(a,b){return a.base+"/"+b+"/xhr"+a.queryString},onHeartbeat:function(){},sendHeartbeat:function(a){a.sendRaw("[]")},onFinished:function(a,b){200===b?a.reconnect():a.onClose(1006,"Connection interrupted ("+b+")",!1)}},bD={getRequest:function(a){var b=new(bG.getXHRAPI());return b.onreadystatechange=b.onprogress=function(){switch(b.readyState){case 3:b.responseText&&b.responseText.length>0&&a.onChunk(b.status,b.responseText);break;case 4:b.responseText&&b.responseText.length>0&&a.onChunk(b.status,b.responseText),a.emit("finished",b.status),a.close()}},b},abortRequest:function(a){a.onreadystatechange=null,a.abort()}},bE={createStreamingSocket:function(a){return this.createSocket(bB,a)},createPollingSocket:function(a){return this.createSocket(bC,a)},createSocket:function(a,b){return new bA(a,b)},createXHR:function(a,b){return this.createRequest(bD,a,b)},createRequest:function(a,b,c){return new bq(a,b,c)}};bE.createXDR=function(a,b){return this.createRequest(bo,a,b)};var bF,bG={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:j,DependenciesReceivers:m,getDefaultStrategy:bm,Transports:av,transportConnectionInitializer:bn,HTTPFactory:bE,TimelineTransport:{name:"jsonp",getAgent:ae},getXHRAPI:function(){return window.XMLHttpRequest},getWebSocketAPI:function(){return window.WebSocket||window.MozWebSocket},setup:function(a){var b=this;window.Pusher=a;var c=function(){b.onDocumentBody(a.ready)};window.JSON?c():n.load("json2",{},c)},getDocument:function(){return document},getProtocol:function(){return this.getDocument().location.protocol},getAuthorizers:function(){return{ajax:A,jsonp:ab}},onDocumentBody:function(a){var b=this;document.body?a():setTimeout(function(){b.onDocumentBody(a)},0)},createJSONPRequest:function(a,b){return new ad(a,b)},createScriptRequest:function(a){return new ac(a)},getLocalStorage:function(){try{return window.localStorage}catch(a){return}},createXHR:function(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest:function(){return new(this.getXHRAPI())},createMicrosoftXHR:function(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork:function(){return aI},createWebSocket:function(a){return new(this.getWebSocketAPI())(a)},createSocketRequest:function(a,b){if(this.isXHRSupported())return this.HTTPFactory.createXHR(a,b);if(this.isXDRSupported(0===b.indexOf("https:")))return this.HTTPFactory.createXDR(a,b);throw"Cross-origin HTTP requests are not supported"},isXHRSupported:function(){var a=this.getXHRAPI();return Boolean(a)&& void 0!==new a().withCredentials},isXDRSupported:function(a){var b=this.getProtocol();return Boolean(window.XDomainRequest)&&b===(a?"https:":"http:")},addUnloadListener:function(a){void 0!==window.addEventListener?window.addEventListener("unload",a,!1):void 0!==window.attachEvent&&window.attachEvent("onunload",a)},removeUnloadListener:function(a){void 0!==window.addEventListener?window.removeEventListener("unload",a,!1):void 0!==window.detachEvent&&window.detachEvent("onunload",a)}};(bF=f||(f={}))[bF.ERROR=3]="ERROR",bF[bF.INFO=6]="INFO",bF[bF.DEBUG=7]="DEBUG";var bH=f,bI=function(){function a(a,b,c){this.key=a,this.session=b,this.events=[],this.options=c||{},this.sent=0,this.uniqueID=0}return a.prototype.log=function(a,b){a<=this.options.level&&(this.events.push(R({},b,{timestamp:Q.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())},a.prototype.error=function(a){this.log(bH.ERROR,a)},a.prototype.info=function(a){this.log(bH.INFO,a)},a.prototype.debug=function(a){this.log(bH.DEBUG,a)},a.prototype.isEmpty=function(){return 0===this.events.length},a.prototype.send=function(a,b){var c=this,d=R({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],a(d,function(a,d){!a&&c.sent++,b&&b(a,d)}),!0},a.prototype.generateUniqueID=function(){return this.uniqueID++,this.uniqueID},a}(),bJ=function(){function a(a,b,c,d){this.name=a,this.priority=b,this.transport=c,this.options=d||{}}return a.prototype.isSupported=function(){return this.transport.isSupported({useTLS:this.options.useTLS})},a.prototype.connect=function(a,b){var c=this;if(!this.isSupported())return bK(new y,b);if(this.priority<a)return bK(new u,b);var d=!1,e=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),f=null,g=function(){e.unbind("initialized",g),e.connect()},h=function(){f=a4.createHandshake(e,function(a){d=!0,k(),b(null,a)})},i=function(a){k(),b(a)},j=function(){var a;k(),a=_(e),b(new v(a))},k=function(){e.unbind("initialized",g),e.unbind("open",h),e.unbind("error",i),e.unbind("closed",j)};return e.bind("initialized",g),e.bind("open",h),e.bind("error",i),e.bind("closed",j),e.initialize(),{abort:function(){!d&&(k(),f?f.close():e.close())},forceMinPriority:function(a){!d&&c.priority<a&&(f?f.close():e.close())}}},a}();function bK(a,b){return Q.defer(function(){b(a)}),{abort:function(){},forceMinPriority:function(){}}}var bL=bG.Transports,bM=function(a,b,c,d,e,f){var g,h=bL[c];if(!h)throw new x(c);return a.enabledTransports&& -1===T(a.enabledTransports,b)||a.disabledTransports&& -1!==T(a.disabledTransports,b)?g=bN:(e=Object.assign({ignoreNullOrigin:a.ignoreNullOrigin},e),g=new bJ(b,d,f?f.getAssistant(h):h,e)),g},bN={isSupported:function(){return!1},connect:function(a,b){var c=Q.defer(function(){b(new y)});return{abort:function(){c.ensureAborted()},forceMinPriority:function(){}}}},bO=function(a,b){var c="socket_id="+encodeURIComponent(a.socketId);for(var d in b.params)c+="&"+encodeURIComponent(d)+"="+encodeURIComponent(b.params[d]);return c},bP=function(a){if(void 0===bG.getAuthorizers()[a.transport])throw"'"+a.transport+"' is not a recognized auth transport";return function(b,c){var e=bO(b,a);bG.getAuthorizers()[a.transport](bG,e,a,d.UserAuthentication,c)}},bQ=function(a,b){var c="socket_id="+encodeURIComponent(a.socketId);for(var d in c+="&channel_name="+encodeURIComponent(a.channelName),b.params)c+="&"+encodeURIComponent(d)+"="+encodeURIComponent(b.params[d]);return c},bR=function(a){if(void 0===bG.getAuthorizers()[a.transport])throw"'"+a.transport+"' is not a recognized auth transport";return function(b,c){var e=bQ(b,a);bG.getAuthorizers()[a.transport](bG,e,a,d.ChannelAuthorization,c)}},bS=function(a,b,c){var d={authTransport:b.transport,authEndpoint:b.endpoint,auth:{params:b.params,headers:b.headers}};return function(b,e){c(a.channel(b.channelName),d).authorize(b.socketId,e)}},bT=function(){return(bT=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function bU(a){return"ws-"+a+".pusher.com"}var bV,bW=function(){var a,b;return{promise:new Promise(function(c,d){a=c,b=d}),resolve:a,reject:b}},bX=(bV=function(a,b){return(bV=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(a,b)},function(a,b){function c(){this.constructor=a}bV(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}),bY=function(a){function b(b){var c=a.call(this,function(a,b){aa.debug("No callbacks on user for "+a)})||this;return c.signin_requested=!1,c.user_data=null,c.serverToUserChannel=null,c.signinDonePromise=null,c._signinDoneResolve=null,c._onAuthorize=function(a,b){if(a){aa.warn("Error during signin: "+a),c._cleanup();return}c.pusher.send_event("pusher:signin",{auth:b.auth,user_data:b.user_data})},c.pusher=b,c.pusher.connection.bind("state_change",function(a){var b=a.previous,d=a.current;"connected"!==b&&"connected"===d&&c._signin(),"connected"===b&&"connected"!==d&&(c._cleanup(),c._newSigninPromiseIfNeeded())}),c.pusher.connection.bind("message",function(a){"pusher:signin_success"===a.event&&c._onSigninSuccess(a.data),c.serverToUserChannel&&c.serverToUserChannel.name===a.channel&&c.serverToUserChannel.handleEvent(a)}),c}return bX(b,a),b.prototype.signin=function(){!this.signin_requested&&(this.signin_requested=!0,this._signin())},b.prototype._signin=function(){if(this.signin_requested)this._newSigninPromiseIfNeeded(),"connected"===this.pusher.connection.state&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize)},b.prototype._onSigninSuccess=function(a){try{this.user_data=JSON.parse(a.user_data)}catch(b){aa.error("Failed parsing user data after signin: "+a.user_data),this._cleanup();return}if("string"!=typeof this.user_data.id||""===this.user_data.id){aa.error("user_data doesn't contain an id. user_data: "+this.user_data),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()},b.prototype._subscribeChannels=function(){var a,b=this;this.serverToUserChannel=new aR("#server-to-user-"+this.user_data.id,this.pusher),this.serverToUserChannel.bind_global(function(a,c){0!==a.indexOf("pusher_internal:")&&0!==a.indexOf("pusher:")&&b.emit(a,c)}),(a=this.serverToUserChannel).subscriptionPending&&a.subscriptionCancelled?a.reinstateSubscription():a.subscriptionPending||"connected"!==b.pusher.connection.state||a.subscribe()},b.prototype._cleanup=function(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()},b.prototype._newSigninPromiseIfNeeded=function(){if(this.signin_requested&&(!this.signinDonePromise||this.signinDonePromise.done)){var a=bW(),b=a.promise,c=a.resolve;a.reject,b.done=!1;var d=function(){b.done=!0};b.then(d).catch(d),this.signinDonePromise=b,this._signinDoneResolve=c}},b}(ak),bZ=function(){function a(b,c){var d,e,f,g,h,i,j,l,m,n,o,q,r,s,t=this;if(b_(b),!(c=c||{}).cluster&&!(c.wsHost||c.httpHost)){var u=p.buildLogSuffix("javascriptQuickStart");aa.warn("You should always specify a cluster when connecting. "+u)}"disableStats"in c&&aa.warn("The disableStats option is deprecated in favor of enableStats"),this.key=b,this.config=(q=c,r=this,s={activityTimeout:q.activityTimeout||k.activityTimeout,cluster:q.cluster||k.cluster,httpPath:q.httpPath||k.httpPath,httpPort:q.httpPort||k.httpPort,httpsPort:q.httpsPort||k.httpsPort,pongTimeout:q.pongTimeout||k.pongTimeout,statsHost:q.statsHost||k.stats_host,unavailableTimeout:q.unavailableTimeout||k.unavailableTimeout,wsPath:q.wsPath||k.wsPath,wsPort:q.wsPort||k.wsPort,wssPort:q.wssPort||k.wssPort,enableStats:(d=q,"enableStats"in d?d.enableStats:"disableStats"in d&&!d.disableStats),httpHost:(e=q,e.httpHost?e.httpHost:e.cluster?"sockjs-"+e.cluster+".pusher.com":k.httpHost),useTLS:function a(b){if("https:"===bG.getProtocol());else if(!1===b.forceTLS)return!1;return!0}(q),wsHost:(f=q,f.wsHost?f.wsHost:f.cluster?bU(f.cluster):bU(k.cluster)),userAuthenticator:(g=q,h=bT({},k.userAuthentication,g.userAuthentication),"customHandler"in h&&null!=h.customHandler?h.customHandler:bP(h)),channelAuthorizer:(i=q,j=r,o=(l=i,m=j,"channelAuthorization"in l?n=bT({},k.channelAuthorization,l.channelAuthorization):(n={transport:l.authTransport||k.authTransport,endpoint:l.authEndpoint||k.authEndpoint},"auth"in l&&("params"in l.auth&&(n.params=l.auth.params),"headers"in l.auth&&(n.headers=l.auth.headers)),"authorizer"in l&&(n.customHandler=bS(m,n,l.authorizer))),n),"customHandler"in o&&null!=o.customHandler?o.customHandler:bR(o))},"disabledTransports"in q&&(s.disabledTransports=q.disabledTransports),"enabledTransports"in q&&(s.enabledTransports=q.enabledTransports),"ignoreNullOrigin"in q&&(s.ignoreNullOrigin=q.ignoreNullOrigin),"timelineParams"in q&&(s.timelineParams=q.timelineParams),"nacl"in q&&(s.nacl=q.nacl),s),this.channels=a4.createChannels(),this.global_emitter=new ak,this.sessionID=Math.floor(1e9*Math.random()),this.timeline=new bI(this.key,this.sessionID,{cluster:this.config.cluster,features:a.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:bH.INFO,version:k.VERSION}),this.config.enableStats&&(this.timelineSender=a4.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+bG.TimelineTransport.name}));var v=function(a){return bG.getDefaultStrategy(t.config,a,bM)};this.connection=a4.createConnectionManager(this.key,{getStrategy:v,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:Boolean(this.config.useTLS)}),this.connection.bind("connected",function(){t.subscribeAll(),t.timelineSender&&t.timelineSender.send(t.connection.isUsingTLS())}),this.connection.bind("message",function(a){var b=0===a.event.indexOf("pusher_internal:");if(a.channel){var c=t.channel(a.channel);c&&c.handleEvent(a)}b||t.global_emitter.emit(a.event,a.data)}),this.connection.bind("connecting",function(){t.channels.disconnect()}),this.connection.bind("disconnected",function(){t.channels.disconnect()}),this.connection.bind("error",function(a){aa.warn(a)}),a.instances.push(this),this.timeline.info({instances:a.instances.length}),this.user=new bY(this),a.isReady&&this.connect()}return a.ready=function(){a.isReady=!0;for(var b=0,c=a.instances.length;b<c;b++)a.instances[b].connect()},a.getClientFeatures=function(){return V(Z({ws:bG.Transports.ws},function(a){return a.isSupported({})}))},a.prototype.channel=function(a){return this.channels.find(a)},a.prototype.allChannels=function(){return this.channels.all()},a.prototype.connect=function(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var a=this.connection.isUsingTLS(),b=this.timelineSender;this.timelineSenderTimer=new P(6e4,function(){b.send(a)})}},a.prototype.disconnect=function(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)},a.prototype.bind=function(a,b,c){return this.global_emitter.bind(a,b,c),this},a.prototype.unbind=function(a,b,c){return this.global_emitter.unbind(a,b,c),this},a.prototype.bind_global=function(a){return this.global_emitter.bind_global(a),this},a.prototype.unbind_global=function(a){return this.global_emitter.unbind_global(a),this},a.prototype.unbind_all=function(a){return this.global_emitter.unbind_all(),this},a.prototype.subscribeAll=function(){var a;for(a in this.channels.channels)this.channels.channels.hasOwnProperty(a)&&this.subscribe(a)},a.prototype.subscribe=function(a){var b=this.channels.add(a,this);return b.subscriptionPending&&b.subscriptionCancelled?b.reinstateSubscription():b.subscriptionPending||"connected"!==this.connection.state||b.subscribe(),b},a.prototype.unsubscribe=function(a){var b=this.channels.find(a);b&&b.subscriptionPending?b.cancelSubscription():(b=this.channels.remove(a))&&b.subscribed&&b.unsubscribe()},a.prototype.send_event=function(a,b,c){return this.connection.send_event(a,b,c)},a.prototype.shouldUseTLS=function(){return this.config.useTLS},a.prototype.signin=function(){this.user.signin()},a.instances=[],a.isReady=!1,a.logToConsole=!1,a.Runtime=bG,a.ScriptReceivers=bG.ScriptReceivers,a.DependenciesReceivers=bG.DependenciesReceivers,a.auth_callbacks=bG.auth_callbacks,a}(),b$=b.default=bZ;function b_(a){if(null==a)throw"You must pass your app key when you instantiate Pusher."}bG.setup(bZ)}])})}}])
//# sourceMappingURL=db0c2712-ab3f5b37d73d499f.js.map